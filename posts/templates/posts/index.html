{% load static %}

<link rel="stylesheet" type="text/css" href="{% static 'posts/style.css' %}">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

<script>
    $(document).ready(function(){
      $(".like-button").click(function(){
          var clickedLikeButton = $(this);
          $.post("{% url 'posts:like'%}",
          {
            post_id : clickedLikeButton.val(),
            csrfmiddlewaretoken: '{{ csrf_token }}'
          },
          function(data,status){
            if(data.is_liked){
              clickedLikeButton.html("Liked");
              if(!clickedLikeButton.hasClass("liked"))
              {
                clickedLikeButton.addClass("liked");
              }
            }
            else{
              clickedLikeButton.html("Like")
              if(clickedLikeButton.hasClass("liked"))
              {
                clickedLikeButton.removeClass("liked");
              }
            }
            $('#'+clickedLikeButton.val()).html( + data.like_count + ' likes');
          });
      });
  });
</script>

<ul class="sidebar-nav">
  {% if user.is_authenticated %}
    <li>User: {{ user.get_username }}</li>
    <li><a href="{% url 'logout'%}?next={{request.path}}">Logout</a></li>
  {% else %}
    <li><a href="{% url 'login'%}?next={{request.path}}">Login</a></li>
  {% endif %}
</ul>

{% if latest_post_list %}
    <ul>
      {% for post in latest_post_list %}
      <div class="container">
        <p class="post-header">@{{ post.owner }}</p>
        <img src="{% static 'posts/images/' %}{{post.media_path}}" alt="My image">
        <div class="post-info">
          <div class="post-like">
            <div>
              {% if post.is_liked %} 
              <button value="{{post.id}}" class="like-button liked">Liked</button>
              {% else %}
              <button value="{{post.id}}" class="like-button">Like</button>
              {% endif %}
              <i style="font-size: 24px;" class="far fa-comment"></i> 
            </div>
            
              <strong id={{post.id}}>{{ post.num_likes }} likes</strong>
          </div>
          <div class="post-desc"><strong>@{{ post.owner }}</strong>  {{post.media_desc}}</div>
        </div>
      </div>
      {% endfor %}
    </ul>
{% else %}
    <p>No posts are available.</p>
{% endif %}


<!--

    {% load static %}
    <img src="{% static 'my_app/example.jpg' %}" alt="My image">

-->