{% load static %}

<link rel="stylesheet" type="text/css" href="{% static 'posts/style.css' %}">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="0px" height="0px">
  <defs>
   <g id="heart">
    <path d="m0 200v-200h200a100 100 90 0 1 0 200 100 100 90 0 1-200 0z"/>
   </g>
  </defs>
</svg>
 
<script>
    $(document).ready(function(){
      $(".like-button").click(function(){
          var clickedLikeButton = $(this);
          $.post("{% url 'posts:like'%}",
          {
            post_id : clickedLikeButton.val(),
            csrfmiddlewaretoken: '{{ csrf_token }}'
          },
          function(data,status){
            if(data.is_liked){
              if(!clickedLikeButton.hasClass("liked"))
              {
                clickedLikeButton.addClass("liked");
              }
            }
            else{
              if(clickedLikeButton.hasClass("liked"))
              {
                clickedLikeButton.removeClass("liked");
              }
            }
            $('#'+clickedLikeButton.val()).html( + data.like_count + ' likes');
          });
      });
  });
</script>

<ul class="sidebar-nav">
  {% if user.is_authenticated %}
    <li>User: {{ user.get_username }}</li>
    <li><a href="{% url 'logout'%}?next={{request.path}}">Logout</a></li>
  {% else %}
    <li><a href="{% url 'login'%}?next={{request.path}}">Login</a></li>
  {% endif %}
</ul>

{% if latest_post_list %}
    <ul>
      {% for post in latest_post_list %}
      <div class="container">
        <p class="post-header">@{{ post.owner }}</p>
        <a href="{% url 'posts:results' post.pk %}">
          <img src="{% static 'posts/images/' %}{{post.media_path}}" alt="My image">
        </a>
        
        <div class="post-info">
          <div class="post-like">
            <div>
              {% if post.is_liked %} 
              <button value="{{post.id}}" class="like-button liked">
              {% else %}
              <button value="{{post.id}}" class="like-button">
              {% endif %}
                <svg viewBox="0 0 400 400" width="32px" height="32px">
                    <use transform="matrix(-.60819 -.60685 .60819 -.60685 170.83 291.51)" stroke="#262626" stroke-linejoin="round" stroke-width="48" xlink:href="#heart"/>
                </svg>
              </button>
              <i style="font-size: 24px;" class="far fa-comment"></i> 
            </div>
            
              <strong id={{post.id}}>{{ post.num_likes }} likes</strong>
              <strong>{{ post.num_comments }} comments</strong>
          </div>
          <div class="post-desc"><strong>@{{ post.owner }}</strong>  {{post.media_desc}}</div>
        </div>
      </div>
      {% endfor %}
    </ul>
{% else %}
    <p>No posts are available.</p>
{% endif %}


<!--

    {% load static %}
    <img src="{% static 'my_app/example.jpg' %}" alt="My image">

-->